<!DOCTYPE html>
<html>
<head>
    <title>Acionamento</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<div class="container mt-5">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <h2 class="mb-4">Insira o numero</h2>
                <div class="form-group">
                    <input type="text" class="form-control" id="chaveInput" placeholder="Insira a chave">
                </div>
                <button class="btn btn-primary" id="buscarButton">Buscar Informa√ß√µes</button>
                <div class="mt-3">
                    <div><strong>Status:</strong> <span id="status"></span></div>
                    <div><strong>Quem Contratou:</strong> <span id="quemContratou"></span></div>
                    <div><strong>Motorista:</strong> <span id="motorista"></span></div>
                    <div><strong>Ve√≠culo:</strong> <span id="veiculo"></span></div>
                
    <div class="alert alert-info">
      <p>Queremos garantir que o processo de transporte ocorra de forma eficiente e sem problemas. Um ponto crucial para isso √© a sua chegada no hor√°rio agendado. Atrasos t√™m impacto direto na opera√ß√£o, causando retrabalho e afetando outros processos. Para evitar complica√ß√µes, pedimos sua coopera√ß√£o em cumprir rigorosamente o hor√°rio de embarque.</p>
    </div>

    <div class="alert alert-secondary">
      <p><strong>Detalhes da Coleta:</strong></p>
      <ul>
        <li><strong>Planilha:</strong><span id="planilha"></span></li>
        <li><strong>Entregas:</strong><span id="entregas"></span></li>
        <li><strong>Origem:</strong> Vinhedo - SP</li>
        <li><strong>Destino Final:</strong><span id="destinoFinal"></span></li>
        <li><strong>Cidades de Entregas:</strong> <em><span id="cidadesEntrega"></span></em></li>
        <li><strong>Volumes:</strong><span id="volumes"></span></li>
        <li><strong>Peso:</strong><span id="peso"></span></li>
        <li><strong>Data e hora de embarque:</strong><em><span id="embarque"></span><em></li>
        <li><strong>Data de descarga:</strong><span id="descarga"></span></li>
        <li><strong>Agendado:</strong> <em><span id="agendado"></span></em></li>
        <li><strong>Refrigerada:</strong> <em><span id="refrigerado"></span></em></li>
        <li><strong>Rastreada:</strong> <em><span id="rastreada"></span></em></li>
        <li><strong>Divis√≥ria:</strong> <em><span id="divisoria"></span></em></li>
        <li><strong>KM:</strong><em><span id="km"></span></em></li>
        <li><strong>Frete:</strong><em><span id="frete"></span></em></li>
      </ul>
    </div>

    <div class="alert alert-warning">
      <p><strong>Aten√ß√£o, querido parceiro!</strong> Para cargas refrigeradas, lembre-se de manter o sistema de refrigera√ß√£o na temperatura adequada (<strong>üå°Ô∏è +2¬∫ a +8¬∫ üå°Ô∏è</strong>). Isso √© fundamental para garantir a qualidade da carga durante o transporte.</p>
    </div>
  </div>
            </div>
        </div>
    </div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        gapi.load('client', function() {
            gapi.client.init({
                apiKey: 'AIzaSyAxGbdWe639fXoxSAnogiMC_sJBFn5uXsk',
                discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(function() {
                document.getElementById("buscarButton").addEventListener("click", buscarInformacoes);
            });
        });

        function buscarInformacoes() {
            const chave = document.getElementById("chaveInput").value;
            
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1I4GB6KQVa_6254wcguR4BzG8FQn96slmWy0usPmxW5k',
                range: 'SITE!D:M',
            }).then(response => {
                const values = response.result.values;
                if (values && values.length > 0) {
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0] === chave) {
                            document.getElementById("planilha").innerText = values[i][0];
                            document.getElementById("embarque").innerText = values[i][0];
                            document.getElementById("status").innerText = values[i][2];
                            document.getElementById("quemContratou").innerText = values[i][3];
                            document.getElementById("motorista").innerText = values[i][4];
                            document.getElementById("destinoFinal").innerText = values[i][5];
                            document.getElementById("cidadesEntrega").innerText = values[i][6];
                            document.getElementById("km").innerText = values[i][7];
                            document.getElementById("veiculo").innerText = values[i][8];
                            document.getElementById("frete").innerText = values[i][9];
                            document.getElementById("rastreada").innerText = values[i][10];
                            document.getElementById("refrigerada").innerText = values[i][11];
                            document.getElementById("divisoria").innerText = values[i][12];
                            document.getElementById("descarga").innerText = values[i][13];
                            document.getElementById("peso").innerText = values[i][14];
                            document.getElementById("entregas").innerText = values[i][15];
                            return; // Encerra o loop ap√≥s encontrar a chave
                        }
                    }
                    document.getElementById("status").innerText = "Chave n√£o encontrada.";
                } else {
                    document.getElementById("status").innerText = "Nenhum dado encontrado.";
                }
            }, response => {
                console.error('Erro ao buscar informa√ß√µes:', response.result.error.message);
            });
        }
    </script>
</body>
</html>
