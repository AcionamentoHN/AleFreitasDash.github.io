<!DOCTYPE html>
<html>
<head>
    <title>Acionamento</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <h2 class="mb-4">Insira o numero</h2>
                <div class="form-group">
                    <input type="text" class="form-control" id="numeroInput" placeholder="Insira o número">
                </div>
                <button class="btn btn-primary" id="buscarButton">Buscar Informações</button>
                <div class="mt-3" id="informacoes"></div>
            </div>
        </div>
    </div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        gapi.load('client', function() {
            gapi.client.init({
                apiKey: 'AIzaSyAxGbdWe639fXoxSAnogiMC_sJBFn5uXsk',
                discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(function() {
                document.getElementById("buscarButton").addEventListener("click", buscarInformacoes);
            });
        });

        function buscarInformacoes() {
            const numero = document.getElementById("numeroInput").value;
            
            return gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1I4GB6KQVa_6254wcguR4BzG8FQn96slmWy0usPmxW5k',
                range: 'MEDIOS!D:M',
    }).then(response => {
        const values = response.result.values;
        if (values && values.length > 0) {
            let informacaoDesejada = null; // Variável para armazenar a informação encontrada
            for (let i = 0; i < values.length; i++) { // Laço para percorrer os valores
                if (values[i][0] == numero) { // Se o valor da coluna D for igual ao input
                    informacaoDesejada = values[i][9]; // Atribui o valor da coluna M à variável
                    break; // Sai do laço
                }
            }
            if (informacaoDesejada) { // Se a informação foi encontrada
                document.getElementById("informacoes").innerText = informacaoDesejada;
            } else { // Se a informação não foi encontrada
                document.getElementById("informacoes").innerText = "Nenhuma informação encontrada para esse número.";
            }
        } else {
            document.getElementById("informacoes").innerText = "Nenhum dado encontrado.";
        }
    }, response => {
        console.error('Erro ao buscar informações:', response.result.error.message);
    });
}
    </script>
</body>
</html>
