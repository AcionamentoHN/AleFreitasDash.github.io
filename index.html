<!DOCTYPE html>
<html>
<head>
    <title>Acionamento</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<div class="container mt-5">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <h2 class="mb-4">Insira o numero</h2>
                <div class="form-group">
                    <input type="text" class="form-control" id="chaveInput" placeholder="Insira a chave">
                </div>
                <button class="btn btn-primary" id="buscarButton">Buscar Informações</button>
                <div class="mt-3">
                    <div><strong>Status:</strong> <span id="status"></span></div>
                    <div><strong>Quem Contratou:</strong> <span id="quemContratou"></span></div>
                    <div><strong>Motorista:</strong> <span id="motorista"></span></div>
                    <div><strong>Destino Final:</strong> <span id="destinoFinal"></span></div>
                    <div><strong>Cidades de Entrega:</strong> <span id="cidadesEntrega"></span></div>
                    <div><strong>KM:</strong> <span id="km"></span></div>
                    <div><strong>Veículo:</strong> <span id="veiculo"></span></div>
                    <div><strong>Frete:</strong> <span id="frete"></span></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        gapi.load('client', function() {
            gapi.client.init({
                apiKey: 'AIzaSyAxGbdWe639fXoxSAnogiMC_sJBFn5uXsk',
                discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(function() {
                document.getElementById("buscarButton").addEventListener("click", buscarInformacoes);
            });
        });

        function buscarInformacoes() {
            const chave = document.getElementById("chaveInput").value;
            
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1I4GB6KQVa_6254wcguR4BzG8FQn96slmWy0usPmxW5k',
                range: 'MEDIOS!D:M',
            }).then(response => {
                const values = response.result.values;
                if (values && values.length > 0) {
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0] === chave) {
                            document.getElementById("status").innerText = values[i][1];
                            document.getElementById("quemContratou").innerText = values[i][2];
                            document.getElementById("motorista").innerText = values[i][3];
                            document.getElementById("destinoFinal").innerText = values[i][4];
                            document.getElementById("cidadesEntrega").innerText = values[i][5];
                            document.getElementById("km").innerText = values[i][6];
                            document.getElementById("veiculo").innerText = values[i][7];
                            document.getElementById("frete").innerText = values[i][8];
                            return; // Encerra o loop após encontrar a chave
                        }
                    }
                    document.getElementById("status").innerText = "Chave não encontrada.";
                } else {
                    document.getElementById("status").innerText = "Nenhum dado encontrado.";
                }
            }, response => {
                console.error('Erro ao buscar informações:', response.result.error.message);
            });
        }
    </script>
</body>
</html>
