<!DOCTYPE html>
<html>
<head>
    <title>Consulta de Distância</title>
    <!-- Inclua os estilos do Bootstrap aqui -->
</head>
<body>
    <div class="container">
        <h1>Consulta de Distância entre Cidades</h1>
        <form id="distanceForm">
            <label for="origin">Cidade de Origem:</label>
            <input type="text" id="origin" required><br><br>
            <label for="destination">Cidade de Destino:</label>
            <input type="text" id="destination" required><br><br>
            <button type="submit">Calcular Distância</button>
        </form>
    </div>

    <script>
        document.getElementById('distanceForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const origin = document.getElementById('origin').value;
            const destination = document.getElementById('destination').value;

            // Chamada à API do Bing Maps para calcular a distância
            const bingApiKey = 'AlqUFiLlbuRfALG8dH9Tca8eA2fnacLq9VX1ic8n29op_INF1sKPZbb3BAE5jZhs';
            const bingMapsUrl = `https://dev.virtualearth.net/REST/v1/Routes/Driving?wp.0=${origin}&wp.1=${destination}&key=${bingApiKey}`;

            fetch(bingMapsUrl)
                .then(response => response.json())
                .then(data => {
                    const distance = data.resourceSets[0].resources[0].travelDistance;
                    console.log(`Distância entre ${origin} e ${destination}: ${distance} km`);

                    // Chamada à API do Google Sheets para atualizar a planilha
                    const googleSheetsApiKey = 'AIzaSyAxGbdWe639fXoxSAnogiMC_sJBFn5uXsk';
                    const spreadsheetId = '1I4GB6KQVa_6254wcguR4BzG8FQn96slmWy0usPmxW5k'; // Substitua pelo ID da sua planilha
                    const range = 'KM!A1'; // Substitua pela célula onde deseja inserir os resultados

                    const googleSheetsUrl = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${googleSheetsApiKey}`;

                    const valueInputOption = 'RAW';
                    const values = [[origin, destination, distance]];

                    fetch(googleSheetsUrl, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ values }),
                    })
                    .then(response => response.json())
                    .then(result => {
                        console.log('Resultado enviado para o Google Sheets:', result);
                    })
                    .catch(error => {
                        console.error('Erro ao enviar para o Google Sheets:', error);
                    });
                })
                .catch(error => {
                    console.error('Erro ao consultar a API do Bing Maps:', error);
                });
        });
    </script>
</body>
</html>
